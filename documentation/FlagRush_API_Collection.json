{
  "info": {
    "name": "FlagRush CTF API",
    "description": "Complete API collection for FlagRush CTF backend with dual-port architecture",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "variable": [
    {
      "key": "main_url",
      "value": "http://localhost:5000",
      "type": "string",
      "description": "Main user-facing API (port 5000)"
    },
    {
      "key": "admin_url",
      "value": "http://localhost:5001",
      "type": "string",
      "description": "Admin API (port 5001)"
    },
    {
      "key": "auth_token",
      "value": "",
      "type": "string"
    }
  ],
  "auth": {
    "type": "bearer",
    "bearer": [
      {
        "key": "token",
        "value": "{{auth_token}}",
        "type": "string"
      }
    ]
  },
  "item": [
    {
      "name": "Main Application (Port 5000)",
      "description": "User-facing endpoints on port 5000",
      "item": [
        {
          "name": "Authentication",
          "item": [
            {
              "name": "Register User",
              "request": {
                "method": "POST",
                "header": [
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"username\": \"testuser\",\n  \"email\": \"test@example.com\",\n  \"password\": \"testpassword123\"\n}"
                },
                "url": {
                  "raw": "{{main_url}}/api/auth/register",
                  "host": ["{{main_url}}"],
                  "path": ["api", "auth", "register"]
                }
              }
            },
            {
              "name": "Login User",
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "exec": [
                      "if (pm.response.code === 200) {",
                      "    const response = pm.response.json();",
                      "    if (response.data && response.data.access_token) {",
                      "        pm.collectionVariables.set('auth_token', response.data.access_token);",
                      "        console.log('Auth token saved:', response.data.access_token);",
                      "    }",
                      "}"
                    ]
                  }
                }
              ],
              "request": {
                "method": "POST",
                "header": [
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"username\": \"testuser\",\n  \"password\": \"testpassword123\"\n}"
                },
                "url": {
                  "raw": "{{main_url}}/api/auth/login",
                  "host": ["{{main_url}}"],
                  "path": ["api", "auth", "login"]
                }
              }
            },
            {
              "name": "Get User Profile",
              "request": {
                "method": "GET",
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{auth_token}}"
                  }
                ],
                "url": {
                  "raw": "{{main_url}}/api/auth/profile",
                  "host": ["{{main_url}}"],
                  "path": ["api", "auth", "profile"]
                }
              }
            }
          ]
        },
        {
          "name": "Challenges",
          "item": [
            {
              "name": "Get All Challenges",
              "request": {
                "method": "GET",
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{auth_token}}"
                  }
                ],
                "url": {
                  "raw": "{{main_url}}/api/challenges/",
                  "host": ["{{main_url}}"],
                  "path": ["api", "challenges", ""]
                }
              }
            },
            {
              "name": "Get Challenge by ID",
              "request": {
                "method": "GET",
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{auth_token}}"
                  }
                ],
                "url": {
                  "raw": "{{main_url}}/api/challenges/1",
                  "host": ["{{main_url}}"],
                  "path": ["api", "challenges", "1"]
                }
              }
            },
            {
              "name": "Get Challenge Categories",
              "request": {
                "method": "GET",
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{auth_token}}"
                  }
                ],
                "url": {
                  "raw": "{{main_url}}/api/challenges/categories",
                  "host": ["{{main_url}}"],
                  "path": ["api", "challenges", "categories"]
                }
              }
            }
          ]
        },
        {
          "name": "Submissions",
          "item": [
            {
              "name": "Submit Flag",
              "request": {
                "method": "POST",
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{auth_token}}"
                  },
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"challenge_id\": 1,\n  \"flag\": \"flag{your_flag_here}\"\n}"
                },
                "url": {
                  "raw": "{{main_url}}/api/submissions/",
                  "host": ["{{main_url}}"],
                  "path": ["api", "submissions", ""]
                }
              }
            },
            {
              "name": "Get User Submissions",
              "request": {
                "method": "GET",
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{auth_token}}"
                  }
                ],
                "url": {
                  "raw": "{{main_url}}/api/submissions/user",
                  "host": ["{{main_url}}"],
                  "path": ["api", "submissions", "user"]
                }
              }
            },
            {
              "name": "Get Challenge Submissions",
              "request": {
                "method": "GET",
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{auth_token}}"
                  }
                ],
                "url": {
                  "raw": "{{main_url}}/api/submissions/challenge/1",
                  "host": ["{{main_url}}"],
                  "path": ["api", "submissions", "challenge", "1"]
                }
              }
            },
            {
              "name": "Get Submission Stats",
              "request": {
                "method": "GET",
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{auth_token}}"
                  }
                ],
                "url": {
                  "raw": "{{main_url}}/api/submissions/stats",
                  "host": ["{{main_url}}"],
                  "path": ["api", "submissions", "stats"]
                }
              }
            },
            {
              "name": "Get Leaderboard",
              "request": {
                "method": "GET",
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{auth_token}}"
                  }
                ],
                "url": {
                  "raw": "{{main_url}}/api/submissions/leaderboard",
                  "host": ["{{main_url}}"],
                  "path": ["api", "submissions", "leaderboard"]
                }
              }
            }
          ]
        }
      ]
    },
    {
      "name": "Admin Application (Port 5001)",
      "description": "Admin-only endpoints on port 5001",
      "item": [
        {
          "name": "Authentication",
          "item": [
            {
              "name": "Admin Login",
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "exec": [
                      "if (pm.response.code === 200) {",
                      "    const response = pm.response.json();",
                      "    if (response.data && response.data.access_token) {",
                      "        pm.collectionVariables.set('auth_token', response.data.access_token);",
                      "        console.log('Admin auth token saved:', response.data.access_token);",
                      "    }",
                      "}"
                    ]
                  }
                }
              ],
              "request": {
                "method": "POST",
                "header": [
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"username\": \"admin\",\n  \"password\": \"your_admin_password\"\n}"
                },
                "url": {
                  "raw": "{{admin_url}}/api/auth/login",
                  "host": ["{{admin_url}}"],
                  "path": ["api", "auth", "login"]
                }
              }
            },
            {
              "name": "Admin Profile",
              "request": {
                "method": "GET",
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{auth_token}}"
                  }
                ],
                "url": {
                  "raw": "{{admin_url}}/api/auth/profile",
                  "host": ["{{admin_url}}"],
                  "path": ["api", "auth", "profile"]
                }
              }
            }
          ]
        },
        {
          "name": "Challenge Management",
          "item": [
            {
              "name": "Create Challenge",
              "request": {
                "method": "POST",
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{auth_token}}"
                  },
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"title\": \"Basic Web Challenge\",\n  \"description\": \"Find the hidden flag in this web application\",\n  \"category\": \"web\",\n  \"points\": 100,\n  \"flag\": \"flag{sample_flag_here}\",\n  \"author\": \"admin\",\n  \"hint_1\": \"Look at the source code\",\n  \"file_url\": \"https://example.com/challenge.zip\"\n}"
                },
                "url": {
                  "raw": "{{admin_url}}/api/admin/challenges",
                  "host": ["{{admin_url}}"],
                  "path": ["api", "admin", "challenges"]
                }
              }
            },
            {
              "name": "Update Challenge",
              "request": {
                "method": "PUT",
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{auth_token}}"
                  },
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"title\": \"Updated Challenge Title\",\n  \"points\": 150,\n  \"is_active\": true,\n  \"description\": \"Updated challenge description\"\n}"
                },
                "url": {
                  "raw": "{{admin_url}}/api/admin/challenges/1",
                  "host": ["{{admin_url}}"],
                  "path": ["api", "admin", "challenges", "1"]
                }
              }
            },
            {
              "name": "Delete Challenge",
              "request": {
                "method": "DELETE",
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{auth_token}}"
                  }
                ],
                "url": {
                  "raw": "{{admin_url}}/api/admin/challenges/1",
                  "host": ["{{admin_url}}"],
                  "path": ["api", "admin", "challenges", "1"]
                }
              }
            },
            {
              "name": "Get All Challenges (Admin View)",
              "request": {
                "method": "GET",
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{auth_token}}"
                  }
                ],
                "url": {
                  "raw": "{{admin_url}}/api/admin/challenges",
                  "host": ["{{admin_url}}"],
                  "path": ["api", "admin", "challenges"]
                }
              }
            },
            {
              "name": "Get Challenge by ID (Admin View)",
              "request": {
                "method": "GET",
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{auth_token}}"
                  }
                ],
                "url": {
                  "raw": "{{admin_url}}/api/admin/challenges/1",
                  "host": ["{{admin_url}}"],
                  "path": ["api", "admin", "challenges", "1"]
                }
              }
            },
            {
              "name": "Toggle Challenge Status",
              "request": {
                "method": "PATCH",
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{auth_token}}"
                  },
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"is_active\": false\n}"
                },
                "url": {
                  "raw": "{{admin_url}}/api/admin/challenges/1/status",
                  "host": ["{{admin_url}}"],
                  "path": ["api", "admin", "challenges", "1", "status"]
                }
              }
            },
            {
              "name": "Get Challenge Statistics",
              "request": {
                "method": "GET",
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{auth_token}}"
                  }
                ],
                "url": {
                  "raw": "{{admin_url}}/api/admin/challenges/1/stats",
                  "host": ["{{admin_url}}"],
                  "path": ["api", "admin", "challenges", "1", "stats"]
                }
              }
            }
          ]
        },
        {
          "name": "Admin Analytics",
          "item": [
            {
              "name": "Get All Submissions (Admin)",
              "request": {
                "method": "GET",
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{auth_token}}"
                  }
                ],
                "url": {
                  "raw": "{{admin_url}}/api/admin/submissions/all",
                  "host": ["{{admin_url}}"],
                  "path": ["api", "admin", "submissions", "all"]
                }
              }
            },
            {
              "name": "Get Platform Statistics",
              "request": {
                "method": "GET",
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{auth_token}}"
                  }
                ],
                "url": {
                  "raw": "{{admin_url}}/api/admin/stats",
                  "host": ["{{admin_url}}"],
                  "path": ["api", "admin", "stats"]
                }
              }
            },
            {
              "name": "Get User Analytics",
              "request": {
                "method": "GET",
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{auth_token}}"
                  }
                ],
                "url": {
                  "raw": "{{admin_url}}/api/admin/users/analytics",
                  "host": ["{{admin_url}}"],
                  "path": ["api", "admin", "users", "analytics"]
                }
              }
            }
          ]
        }
      ]
    }
  ]
}
